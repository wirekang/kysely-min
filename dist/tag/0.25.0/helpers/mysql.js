import{J as n,R as o,C as e,al as t,I as s}from"../sql-Sq1aJORa.js";function a(o){return n`(select cast(coalesce(json_arrayagg(json_object(${n.join(r(o.toOperationNode(),"agg"))})), '[]') as json) from ${o} as agg)`}function i(o){return n`(select json_object(${n.join(r(o.toOperationNode(),"obj"))}) from ${o} as obj)`}function l(o){return n`json_object(${n.join(Object.keys(o).flatMap((e=>[n.lit(e),o[e]])))})`}function r(a,i){return a.selections.flatMap((({selection:a})=>{if(o.is(a)&&e.is(a.column))return[n.lit(a.column.column.name),n.id(i,a.column.column.name)];if(e.is(a))return[n.lit(a.column.name),n.id(i,a.column.name)];if(t.is(a)&&s.is(a.alias))return[n.lit(a.alias.name),n.id(i,a.alias.name)];throw new Error("MySQL jsonArrayFrom and jsonObjectFrom functions can only handle explicit selections due to limitations of the json_object function. selectAll() is not allowed in the subquery.")}))}export{a as jsonArrayFrom,l as jsonBuildObject,i as jsonObjectFrom};
